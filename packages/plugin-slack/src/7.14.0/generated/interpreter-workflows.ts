// AUTO-GENERATED by scripts/codegen.ts â€” do not edit

import type { Interpreter, TypedNode } from "@mvfm/core";
import { defineInterpreter, eval_ } from "@mvfm/core";
import type { SLACK_NODE_KINDS_WORKFLOWS } from "./node-kinds-workflows";

type SlackWorkflowsKind = (typeof SLACK_NODE_KINDS_WORKFLOWS)[number];

interface SlackWorkflowsBaseNode<K extends SlackWorkflowsKind = SlackWorkflowsKind>
  extends TypedNode<unknown> {
  kind: K;
  params?: TypedNode<Record<string, unknown>> | null;
  config: { token: string };
}

export interface SlackWorkflowsFeaturedAddNode
  extends SlackWorkflowsBaseNode<"slack/workflows_featured_add"> {}
export interface SlackWorkflowsFeaturedListNode
  extends SlackWorkflowsBaseNode<"slack/workflows_featured_list"> {}
export interface SlackWorkflowsFeaturedRemoveNode
  extends SlackWorkflowsBaseNode<"slack/workflows_featured_remove"> {}
export interface SlackWorkflowsFeaturedSetNode
  extends SlackWorkflowsBaseNode<"slack/workflows_featured_set"> {}
export interface SlackWorkflowsStepCompletedNode
  extends SlackWorkflowsBaseNode<"slack/workflows_stepCompleted"> {}
export interface SlackWorkflowsStepFailedNode
  extends SlackWorkflowsBaseNode<"slack/workflows_stepFailed"> {}
export interface SlackWorkflowsUpdateStepNode
  extends SlackWorkflowsBaseNode<"slack/workflows_updateStep"> {}

export const NODE_TO_METHOD_WORKFLOWS: Record<string, string> = {
  "slack/workflows_featured_add": "workflows.featured.add",
  "slack/workflows_featured_list": "workflows.featured.list",
  "slack/workflows_featured_remove": "workflows.featured.remove",
  "slack/workflows_featured_set": "workflows.featured.set",
  "slack/workflows_stepCompleted": "workflows.stepCompleted",
  "slack/workflows_stepFailed": "workflows.stepFailed",
  "slack/workflows_updateStep": "workflows.updateStep",
};

declare module "@mvfm/core" {
  interface NodeTypeMap {
    "slack/workflows_featured_add": SlackWorkflowsFeaturedAddNode;
    "slack/workflows_featured_list": SlackWorkflowsFeaturedListNode;
    "slack/workflows_featured_remove": SlackWorkflowsFeaturedRemoveNode;
    "slack/workflows_featured_set": SlackWorkflowsFeaturedSetNode;
    "slack/workflows_stepCompleted": SlackWorkflowsStepCompletedNode;
    "slack/workflows_stepFailed": SlackWorkflowsStepFailedNode;
    "slack/workflows_updateStep": SlackWorkflowsUpdateStepNode;
  }
}

interface SlackClientLike {
  apiCall(method: string, params?: Record<string, unknown>): Promise<unknown>;
}

export function createSlackWorkflowsInterpreter(client: SlackClientLike): Interpreter {
  const handler = async function* (node: SlackWorkflowsBaseNode) {
    const method = NODE_TO_METHOD_WORKFLOWS[node.kind];
    if (!method) throw new Error(`Slack interpreter: unknown node kind "${node.kind}"`);
    const params = node.params != null ? yield* eval_(node.params) : undefined;
    return await client.apiCall(method, params);
  };

  return defineInterpreter<SlackWorkflowsKind>()({
    "slack/workflows_featured_add": async function* (node: SlackWorkflowsFeaturedAddNode) {
      return yield* handler(node);
    },
    "slack/workflows_featured_list": async function* (node: SlackWorkflowsFeaturedListNode) {
      return yield* handler(node);
    },
    "slack/workflows_featured_remove": async function* (node: SlackWorkflowsFeaturedRemoveNode) {
      return yield* handler(node);
    },
    "slack/workflows_featured_set": async function* (node: SlackWorkflowsFeaturedSetNode) {
      return yield* handler(node);
    },
    "slack/workflows_stepCompleted": async function* (node: SlackWorkflowsStepCompletedNode) {
      return yield* handler(node);
    },
    "slack/workflows_stepFailed": async function* (node: SlackWorkflowsStepFailedNode) {
      return yield* handler(node);
    },
    "slack/workflows_updateStep": async function* (node: SlackWorkflowsUpdateStepNode) {
      return yield* handler(node);
    },
  });
}
