// AUTO-GENERATED by scripts/codegen.ts â€” do not edit

import type { Interpreter, TypedNode } from "@mvfm/core";
import { defineInterpreter, eval_ } from "@mvfm/core";
import type { SLACK_NODE_KINDS_REMINDERS } from "./node-kinds-reminders";

type SlackRemindersKind = (typeof SLACK_NODE_KINDS_REMINDERS)[number];

interface SlackRemindersBaseNode<K extends SlackRemindersKind = SlackRemindersKind>
  extends TypedNode<unknown> {
  kind: K;
  params?: TypedNode<Record<string, unknown>> | null;
  config: { token: string };
}

export interface SlackRemindersAddNode extends SlackRemindersBaseNode<"slack/reminders_add"> {}
export interface SlackRemindersCompleteNode
  extends SlackRemindersBaseNode<"slack/reminders_complete"> {}
export interface SlackRemindersDeleteNode
  extends SlackRemindersBaseNode<"slack/reminders_delete"> {}
export interface SlackRemindersInfoNode extends SlackRemindersBaseNode<"slack/reminders_info"> {}
export interface SlackRemindersListNode extends SlackRemindersBaseNode<"slack/reminders_list"> {}

export const NODE_TO_METHOD_REMINDERS: Record<string, string> = {
  "slack/reminders_add": "reminders.add",
  "slack/reminders_complete": "reminders.complete",
  "slack/reminders_delete": "reminders.delete",
  "slack/reminders_info": "reminders.info",
  "slack/reminders_list": "reminders.list",
};

declare module "@mvfm/core" {
  interface NodeTypeMap {
    "slack/reminders_add": SlackRemindersAddNode;
    "slack/reminders_complete": SlackRemindersCompleteNode;
    "slack/reminders_delete": SlackRemindersDeleteNode;
    "slack/reminders_info": SlackRemindersInfoNode;
    "slack/reminders_list": SlackRemindersListNode;
  }
}

interface SlackClientLike {
  apiCall(method: string, params?: Record<string, unknown>): Promise<unknown>;
}

export function createSlackRemindersInterpreter(client: SlackClientLike): Interpreter {
  const handler = async function* (node: SlackRemindersBaseNode) {
    const method = NODE_TO_METHOD_REMINDERS[node.kind];
    if (!method) throw new Error(`Slack interpreter: unknown node kind "${node.kind}"`);
    const params = node.params != null ? yield* eval_(node.params) : undefined;
    return await client.apiCall(method, params);
  };

  return defineInterpreter<SlackRemindersKind>()({
    "slack/reminders_add": async function* (node: SlackRemindersAddNode) {
      return yield* handler(node);
    },
    "slack/reminders_complete": async function* (node: SlackRemindersCompleteNode) {
      return yield* handler(node);
    },
    "slack/reminders_delete": async function* (node: SlackRemindersDeleteNode) {
      return yield* handler(node);
    },
    "slack/reminders_info": async function* (node: SlackRemindersInfoNode) {
      return yield* handler(node);
    },
    "slack/reminders_list": async function* (node: SlackRemindersListNode) {
      return yield* handler(node);
    },
  });
}
