// AUTO-GENERATED by scripts/codegen.ts â€” do not edit

import type { Interpreter, TypedNode } from "@mvfm/core";
import { defineInterpreter, eval_ } from "@mvfm/core";
import type { SLACK_NODE_KINDS_APPS } from "./node-kinds-apps";

type SlackAppsKind = (typeof SLACK_NODE_KINDS_APPS)[number];

interface SlackAppsBaseNode<K extends SlackAppsKind = SlackAppsKind> extends TypedNode<unknown> {
  kind: K;
  params?: TypedNode<Record<string, unknown>> | null;
  config: { token: string };
}

export interface SlackAppsConnectionsOpenNode
  extends SlackAppsBaseNode<"slack/apps_connections_open"> {}
export interface SlackAppsEventAuthorizationsListNode
  extends SlackAppsBaseNode<"slack/apps_event_authorizations_list"> {}
export interface SlackAppsManifestCreateNode
  extends SlackAppsBaseNode<"slack/apps_manifest_create"> {}
export interface SlackAppsManifestDeleteNode
  extends SlackAppsBaseNode<"slack/apps_manifest_delete"> {}
export interface SlackAppsManifestExportNode
  extends SlackAppsBaseNode<"slack/apps_manifest_export"> {}
export interface SlackAppsManifestUpdateNode
  extends SlackAppsBaseNode<"slack/apps_manifest_update"> {}
export interface SlackAppsManifestValidateNode
  extends SlackAppsBaseNode<"slack/apps_manifest_validate"> {}
export interface SlackAppsUninstallNode extends SlackAppsBaseNode<"slack/apps_uninstall"> {}

export const NODE_TO_METHOD_APPS: Record<string, string> = {
  "slack/apps_connections_open": "apps.connections.open",
  "slack/apps_event_authorizations_list": "apps.event.authorizations.list",
  "slack/apps_manifest_create": "apps.manifest.create",
  "slack/apps_manifest_delete": "apps.manifest.delete",
  "slack/apps_manifest_export": "apps.manifest.export",
  "slack/apps_manifest_update": "apps.manifest.update",
  "slack/apps_manifest_validate": "apps.manifest.validate",
  "slack/apps_uninstall": "apps.uninstall",
};

declare module "@mvfm/core" {
  interface NodeTypeMap {
    "slack/apps_connections_open": SlackAppsConnectionsOpenNode;
    "slack/apps_event_authorizations_list": SlackAppsEventAuthorizationsListNode;
    "slack/apps_manifest_create": SlackAppsManifestCreateNode;
    "slack/apps_manifest_delete": SlackAppsManifestDeleteNode;
    "slack/apps_manifest_export": SlackAppsManifestExportNode;
    "slack/apps_manifest_update": SlackAppsManifestUpdateNode;
    "slack/apps_manifest_validate": SlackAppsManifestValidateNode;
    "slack/apps_uninstall": SlackAppsUninstallNode;
  }
}

interface SlackClientLike {
  apiCall(method: string, params?: Record<string, unknown>): Promise<unknown>;
}

export function createSlackAppsInterpreter(client: SlackClientLike): Interpreter {
  const handler = async function* (node: SlackAppsBaseNode) {
    const method = NODE_TO_METHOD_APPS[node.kind];
    if (!method) throw new Error(`Slack interpreter: unknown node kind "${node.kind}"`);
    const params = node.params != null ? yield* eval_(node.params) : undefined;
    return await client.apiCall(method, params);
  };

  return defineInterpreter<SlackAppsKind>()({
    "slack/apps_connections_open": async function* (node: SlackAppsConnectionsOpenNode) {
      return yield* handler(node);
    },
    "slack/apps_event_authorizations_list": async function* (
      node: SlackAppsEventAuthorizationsListNode,
    ) {
      return yield* handler(node);
    },
    "slack/apps_manifest_create": async function* (node: SlackAppsManifestCreateNode) {
      return yield* handler(node);
    },
    "slack/apps_manifest_delete": async function* (node: SlackAppsManifestDeleteNode) {
      return yield* handler(node);
    },
    "slack/apps_manifest_export": async function* (node: SlackAppsManifestExportNode) {
      return yield* handler(node);
    },
    "slack/apps_manifest_update": async function* (node: SlackAppsManifestUpdateNode) {
      return yield* handler(node);
    },
    "slack/apps_manifest_validate": async function* (node: SlackAppsManifestValidateNode) {
      return yield* handler(node);
    },
    "slack/apps_uninstall": async function* (node: SlackAppsUninstallNode) {
      return yield* handler(node);
    },
  });
}
