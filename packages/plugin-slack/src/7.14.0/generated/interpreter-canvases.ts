// AUTO-GENERATED by scripts/codegen.ts â€” do not edit

import type { Interpreter, TypedNode } from "@mvfm/core";
import { defineInterpreter, eval_ } from "@mvfm/core";
import type { SLACK_NODE_KINDS_CANVASES } from "./node-kinds-canvases";

type SlackCanvasesKind = (typeof SLACK_NODE_KINDS_CANVASES)[number];

interface SlackCanvasesBaseNode<K extends SlackCanvasesKind = SlackCanvasesKind>
  extends TypedNode<unknown> {
  kind: K;
  params?: TypedNode<Record<string, unknown>> | null;
  config: { token: string };
}

export interface SlackCanvasesAccessDeleteNode
  extends SlackCanvasesBaseNode<"slack/canvases_access_delete"> {}
export interface SlackCanvasesAccessSetNode
  extends SlackCanvasesBaseNode<"slack/canvases_access_set"> {}
export interface SlackCanvasesCreateNode extends SlackCanvasesBaseNode<"slack/canvases_create"> {}
export interface SlackCanvasesDeleteNode extends SlackCanvasesBaseNode<"slack/canvases_delete"> {}
export interface SlackCanvasesEditNode extends SlackCanvasesBaseNode<"slack/canvases_edit"> {}
export interface SlackCanvasesSectionsLookupNode
  extends SlackCanvasesBaseNode<"slack/canvases_sections_lookup"> {}

export const NODE_TO_METHOD_CANVASES: Record<string, string> = {
  "slack/canvases_access_delete": "canvases.access.delete",
  "slack/canvases_access_set": "canvases.access.set",
  "slack/canvases_create": "canvases.create",
  "slack/canvases_delete": "canvases.delete",
  "slack/canvases_edit": "canvases.edit",
  "slack/canvases_sections_lookup": "canvases.sections.lookup",
};

declare module "@mvfm/core" {
  interface NodeTypeMap {
    "slack/canvases_access_delete": SlackCanvasesAccessDeleteNode;
    "slack/canvases_access_set": SlackCanvasesAccessSetNode;
    "slack/canvases_create": SlackCanvasesCreateNode;
    "slack/canvases_delete": SlackCanvasesDeleteNode;
    "slack/canvases_edit": SlackCanvasesEditNode;
    "slack/canvases_sections_lookup": SlackCanvasesSectionsLookupNode;
  }
}

interface SlackClientLike {
  apiCall(method: string, params?: Record<string, unknown>): Promise<unknown>;
}

export function createSlackCanvasesInterpreter(client: SlackClientLike): Interpreter {
  const handler = async function* (node: SlackCanvasesBaseNode) {
    const method = NODE_TO_METHOD_CANVASES[node.kind];
    if (!method) throw new Error(`Slack interpreter: unknown node kind "${node.kind}"`);
    const params = node.params != null ? yield* eval_(node.params) : undefined;
    return await client.apiCall(method, params);
  };

  return defineInterpreter<SlackCanvasesKind>()({
    "slack/canvases_access_delete": async function* (node: SlackCanvasesAccessDeleteNode) {
      return yield* handler(node);
    },
    "slack/canvases_access_set": async function* (node: SlackCanvasesAccessSetNode) {
      return yield* handler(node);
    },
    "slack/canvases_create": async function* (node: SlackCanvasesCreateNode) {
      return yield* handler(node);
    },
    "slack/canvases_delete": async function* (node: SlackCanvasesDeleteNode) {
      return yield* handler(node);
    },
    "slack/canvases_edit": async function* (node: SlackCanvasesEditNode) {
      return yield* handler(node);
    },
    "slack/canvases_sections_lookup": async function* (node: SlackCanvasesSectionsLookupNode) {
      return yield* handler(node);
    },
  });
}
