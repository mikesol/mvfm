---
import Base from "../layouts/Base.astro";
import { Code } from "astro:components";
import Playground from "../components/Playground";
import { getAllExamples } from "../examples";
import { MONO_THEME } from "../themes/mono";

export function getStaticPaths() {
  const examples = getAllExamples();
  return Object.entries(examples).map(([kind, example]) => ({
    params: { slug: kind },
    props: { kind, ...example },
  }));
}

const { kind, description, code, pglite, mockInterpreter } = Astro.props;
---

<Base title={`${kind} â€” MVFM`}>
  <div class="pt-4">
    <h1 class="text-2xl font-bold text-base-50 tracking-tight">{kind}</h1>
    <p class="mt-2 text-base text-base-500">{description}</p>
    <div class="playground-wrapper mt-10">
      <div class="playground-fallback border border-base-800">
        <Code code={code} lang="typescript" theme={MONO_THEME} />
      </div>
      <Playground code={code} pglite={pglite} mockInterpreter={mockInterpreter} client:load />
    </div>
  </div>
</Base>

<style is:global>
  /* Hide fallback once the interactive editor mounts */
  .playground-wrapper:has(.playground-ready) .playground-fallback {
    display: none;
  }
  /* Hide the editor until it's ready */
  .playground-editor {
    display: none;
  }
  .playground-wrapper:has(.playground-ready) .playground-editor {
    display: block;
  }
  /* Match fallback styling to the editor */
  .playground-fallback pre {
    padding: 16px;
    font-size: 0.875rem;
    line-height: 1.625;
    tab-size: 2;
    margin: 0;
  }
</style>
