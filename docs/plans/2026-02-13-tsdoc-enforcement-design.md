# TSDoc Comments + api-extractor Enforcement

**Issue:** #31
**Date:** 2026-02-13

## Problem

The repo has ~5% TSDoc coverage. Autogenerated API docs (#6) depend on TSDoc being present. Without enforcement, plugins will ship undocumented.

## Decision: api-extractor over ESLint

The project uses Biome (not ESLint). Adding `eslint-plugin-tsdoc` would mean a second linter. Instead, `@microsoft/api-extractor` runs as a standalone post-build step against `dist/index.d.ts`, validates TSDoc on the public API surface, and produces artifacts useful for future doc generation.

## TSDoc Scope

Every public export in `src/index.ts` gets a TSDoc comment at its declaration site:

- **Core types** (`Expr`, `ASTNode`, `Program`, `PluginContext`, `PluginDefinition`, `Plugin`, `Interpreter`, `InterpreterFragment`, `TraitImpl`): Brief description. `@example` where non-obvious.
- **Method interfaces** (`NumMethods`, `EqMethods`, `OrdMethods`, `StrMethods`, `BooleanMethods`, `ControlMethods`, `StMethods`, `FiberMethods`, `ErrorMethods`, `ShowMethods`, `SemigroupMethods`, `MonoidMethods`, `SemiringMethods`, `HeytingAlgebraMethods`, `BoundedMethods`, `PostgresMethods`, `PostgresConfig`, `PostgresClient`): One-liner on interface, `@param`/`@returns` on each method.
- **Plugin definitions** (`num`, `eq`, `ord`, `str`, `boolean`, `control`, `st`, `fiber`, `error`, `show`, `semigroup`, `monoid`, `semiring`, `heytingAlgebra`, `bounded`, `postgres`): What the plugin provides, its namespace.
- **Interpreter exports** (`coreInterpreter`, `numInterpreter`, `strInterpreter`, `booleanInterpreter`, `eqInterpreter`, `ordInterpreter`, `errorInterpreter`, `fiberInterpreter`, `postgresInterpreter`, `wrapPostgresJs`): What they interpret.
- **Functions** (`composeInterpreters`, `ilo`, `inferType`, `resolveSchemaType`, `array`, `nullable`): `@param`, `@returns`, `@example`.
- **Schema types** (`SchemaTag`, `ArraySchema`, `NullableSchema`, `SchemaType`, `SchemaShape`, `InferSchema`): What they represent.

Internal/private functions are out of scope.

## api-extractor Setup

- **Install**: `@microsoft/api-extractor` as devDependency
- **Config**: `api-extractor.json` at repo root
  - `mainEntryPointFilePath`: `./dist/index.d.ts`
  - `apiReport.enabled`: true (committed `.api.md` for PR diffing)
  - `docModel.enabled`: true (`.api.json` for future doc gen #6)
  - Release tags: implicit `@public` (no explicit tags required)
- **Integration**: `npm run check` becomes `biome check . && api-extractor run --local`
- **CI**: Already runs `npm run check`, so enforcement is automatic

## Tags Required

- `@param` for function/method parameters
- `@returns` for return values
- `@example` for non-obvious usage (core `ilo()`, `composeInterpreters`, schema helpers)
