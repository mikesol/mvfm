# Resend Typing Hardening Implementation Plan

> **For Claude:** REQUIRED SUB-SKILL: Use superpowers:executing-plans to implement this plan task-by-task.

**Goal:** Replace generic resend plugin input/output typing with resend-node v6.9.2 request/response types for currently implemented operations only.

**Architecture:** Keep AST node construction and interpreter/handlers unchanged. Tighten compile-time contracts at the plugin method boundary by importing resend type definitions and threading those types through `ResendMethods` and helper signatures.

**Tech Stack:** TypeScript, pnpm workspaces, Vitest, Biome, API Extractor, resend-node v6.9.2 types.

---

### Task 1: Add resend SDK type dependency

**Files:**
- Modify: `packages/plugin-resend/package.json`

**Step 1: Add dependency**
- Add `resend` as a devDependency pinned to `6.9.2`.

**Step 2: Build package to verify dependency resolves**
Run: `pnpm --filter @mvfm/core run build && pnpm --filter @mvfm/plugin-resend run build`
Expected: PASS

### Task 2: Harden resend method signatures

**Files:**
- Modify: `packages/plugin-resend/src/6.9.2/index.ts`

**Step 1: Write failing type checks (tests)**
- Add/adjust compile-time assertions in resend tests so old `Record<string, unknown>` surface would fail.

**Step 2: Run test command to confirm failure**
Run: `pnpm --filter @mvfm/plugin-resend run test`
Expected: Type/test failure before implementation.

**Step 3: Implement typed signatures**
- Import and apply resend-node request/response types for all implemented methods.
- Keep node kinds and emitted AST fields unchanged.

**Step 4: Re-run package checks**
Run: `pnpm --filter @mvfm/plugin-resend run check`
Expected: PASS

### Task 3: Regenerate public API report and verify

**Files:**
- Modify (generated by check): `packages/plugin-resend/etc/plugin-resend.api.md`
- Modify (generated by check): `packages/plugin-resend/etc/plugin-resend.api.json`

**Step 1: Run check**
Run: `pnpm --filter @mvfm/plugin-resend run check`
Expected: PASS and updated API report reflecting typed public exports.

### Task 4: Full targeted validation

**Files:**
- No additional source changes.

**Step 1: Run build/check/test sequence**
Run: `pnpm --filter @mvfm/core run build && pnpm --filter @mvfm/plugin-resend run build && pnpm --filter @mvfm/plugin-resend run check && pnpm --filter @mvfm/plugin-resend run test`
Expected: build/check pass; tests pass except environment-restricted localhost integration cases where applicable.

**Step 2: Commit**
Run:
```bash
git add packages/plugin-resend/package.json packages/plugin-resend/src/6.9.2/index.ts packages/plugin-resend/tests/6.9.2/index.test.ts packages/plugin-resend/etc/plugin-resend.api.md packages/plugin-resend/etc/plugin-resend.api.json docs/plans/2026-02-15-resend-typing-hardening-design.md docs/plans/2026-02-15-resend-typing-hardening.md
git commit -m "feat(plugin-resend): harden typed request/response surfaces"
```
Expected: clean commit with docs + implementation + API report.
